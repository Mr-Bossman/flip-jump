start:
startup


// shl
rep(256, i) test_shl 2, i
//rep(256, i) output '='
output '\n'
SHL_NUM = 0x3771224734197822850855879822771064752667109488401137835635880083975297111641791589772538045634318741231569920967549754511818091885227884937694366230520961814586789716661199648094386883204949869817434294548121519160645250663827751879747725351975088689021678084479267308889211182179276420705922377938761349892386006452567280886228003631313658292602522199492665276039503252259011137235161991107340439967044205110378168318474126325154836676168433753882375764244924820848450586220236504011230433979229026224914950085176912096170203971353538318356655373938374990853178317575087483112906753967105595570168440676305410405814507825671979732714087209074665194940940073497167940090894354508861112189294814938642310108846730732931736365102312491357649296808420146706513156169815648949614191033566211501077073338490408756012567098536313803713528492566991793140882594706158028790265958055647009029461139159925846212863248814935534487398342710654517306260189949088746719352238192196159296098810491642826552555262442149392939803043245082371465868976354044120266390179766655916573632471359359814374025443239739736362206856341689575919058432216506994308255659246606459021089884019247829575196189633968650163398860670582771680210145855562064815324585468794517970968535574826086186054300060675295146085858891583748178279374760871367256437307428485949206511738520917138354784700133196436292664091358199337384882130596926618576129947640428821766104485792832335739445785500845297820893303678171233700411794935111321618594053534605524074252516638706828006794385502598481659558052081866258620702564339551543904636884358896979127841700885030539957184047066103788163035024363435258745433451349707525832269723830416339094906732330150648198276338753701795473131686374165713033882490131976538716344724088489120004636951936868136175087201740250118876889815909184289156771150235887622989327773406356810082271840632758332004428943889876255731850417110420037047
rep(100, i) test_shl 16, (SHL_NUM>>(64*i))&((1<<64)-1)
//rep(100, i) output '='
output '\n'
output '\n'


// shr
rep(256, i) test_shr 2, i
//rep(256, i) output '='
output '\n'
SHR_NUM = 0x1458559382924546767601076675608180050337231665813800295333451697278531786297237582220655367664512100847313572841483539291203317994328797999635917827506956040943212509959656984215024510441085474035808673578885542307051166664962833550456377342694623624067834478356662383422378577601834327787523135396263248742302833093602111535162654089159760235291385144794300941411308287450274584316075439721471784466617003796451126042947769223700098621663393188400429277578380161814008664792838396166601576304595901345431038415155252752252978073743477939213470651754267062613583652466212335666851181735753096460680134796158613917862310288972541504089105315970545804364995417813089185601317747553153680420615927218180366835022692720655776052421142164120407508322792662565370948169425263999433437363374880248075217848503293197344935319092430138861909308950273167725953640270471255722901476792464040246768724377783153085411636617257194116417690657133165584768944331080648598072550556281924561268684315786937857136439430729248391646433491897298833779534623901825155421569718311787828645741995504012604036386359871546969973266625828828676926481524808039538494219912005117048304299736029889791933799478532985392209496302962512760261808793078291144656194820031319061060456009276180579522259708644268442996672312341745921473920792841578505585622357811037168731442217600823975181016974967091840931291095306153048720217248608551964794302936860610853895126146884068447616629627634188375548009840380036686445968553426335433877747236797965879414809361632132341696117108346852433140670062812308109636952723838637416852741526376388213404404287435649407264556445253113144023333914411825534841037000231296143522179108270008426039419211433894090478862475534559262888722816775107115868096078789007746869994803824793047677813587448755811684614915575876730223901163422463356279812332550663622528904141348835231991397677689104239004548886067377594315212532308415545
rep(100, i) test_shr 16, (SHR_NUM>>(64*i))&((1<<64)-1)
//rep(100, i) output '='
output '\n'
output '\n'


// add_count_bits
rep(256, i) test_add_count_bits i&0xf, i>>4
//rep(256, i) output '='
output '\n'

// count_bits
CB_NUM = 0x1035011844748711930328220764526225884248175937077217944729793414599784381410657474711057484681669921029980832920946845310207579968080250704993043171820609315179317038442920364891215546877503786677427184345693833808058856589864434088842388411874924378456265164171701441998400996739896481456356354931343472828318407505857732424192462502252292499631015140965638107373720282737334757557596087542071735863052318987566426922159569959912177606919857690603909695272288754400043057553834988157969144402996324068992735081519929942165039452930995869037497438672841281996994359431040090398713394696926392541727834718705966637806111713317777067527259518019489032987691580313109314554204549253741010607862632927711317126552680329452603852207471775180098638225564843133998790949561299573869573277093503253497452381451420978159756868694917362412450909301886214965414070547973470883423843919265479134871001221270454671487133631404852069214153447269824715098214194139864646988880972619785293258018151101328233333126222380244251346825085315423096099617687280684553224675214334382210513382704066344854664639909114224701281562821383289861654868722168318803743612112644454808771723108532912574074482741242958824626030590300813340780985955795362848549434603200538483254208263202045838612092720728483784490938468895401759867184015812321651765907253899731212038858117069811700596588414755588081735148393273270481293416382266737054475113226464161843481996193388311153697015193878973764063933951072847428761545851859329929820449883326983521326612640795033789126321109995956448543122904714748326653589405443140514624181938779299643155733800927785149206263233331942274329405688531378820099563221629714505122864928864998874975309312608567645369975101831677367984986266063661186602277392893209213397962925425167279547157538853380242425249492263536586415228245087158703672715377353649045857642693733015177955380390126016242432660874446897410669299852774921747
rep(100, i) test_count_bits_64 (CB_NUM>>(64*i))&((1<<64)-1)
//rep(100, i) output '='
output '\n'
output '\n'


loop
hex.init


ah: hex.vec 1
bh: hex.vec 2
ch: hex.vec 2
xh: hex.vec 16
count: hex.vec 2

ret: ;0


add_count_bits_2:
    hex.add_count_bits 2, bh, ah
    fret ret

count_bits_64:
    hex.count_bits 16, count, xh
    fret ret



def test_add_count_bits dst, x @ lt, eq, gt, end < ah, bh, ch, add_count_bits_2, ret {
    hex.set ah, x
    hex.set 2, bh, dst
    hex.set 2, ch, dst + ((x>>0)&1) + ((x>>1)&1) + ((x>>2)&1) + ((x>>3)&1)
    fcall add_count_bits_2, ret
    hex.cmp 2, bh, ch, lt, eq, gt

  lt:
    output '<'
    ;end
  eq:
    output '='
    ;end
  gt:
    output '>'
    ;end

  end:
}

def test_count_bits_64 x @ lt, eq, gt, end < xh, count, ch, count_bits_64, ret {
    hex.set 16, xh, x
    hex.set 2, ch, ((x>>0)&1)+((x>>1)&1)+((x>>2)&1)+((x>>3)&1)+((x>>4)&1)+((x>>5)&1)+((x>>6)&1)+((x>>7)&1)+((x>>8)&1)+((x>>9)&1)+((x>>10)&1)+((x>>11)&1)+((x>>12)&1)+((x>>13)&1)+((x>>14)&1)+((x>>15)&1)+((x>>16)&1)+((x>>17)&1)+((x>>18)&1)+((x>>19)&1)+((x>>20)&1)+((x>>21)&1)+((x>>22)&1)+((x>>23)&1)+((x>>24)&1)+((x>>25)&1)+((x>>26)&1)+((x>>27)&1)+((x>>28)&1)+((x>>29)&1)+((x>>30)&1)+((x>>31)&1)+((x>>32)&1)+((x>>33)&1)+((x>>34)&1)+((x>>35)&1)+((x>>36)&1)+((x>>37)&1)+((x>>38)&1)+((x>>39)&1)+((x>>40)&1)+((x>>41)&1)+((x>>42)&1)+((x>>43)&1)+((x>>44)&1)+((x>>45)&1)+((x>>46)&1)+((x>>47)&1)+((x>>48)&1)+((x>>49)&1)+((x>>50)&1)+((x>>51)&1)+((x>>52)&1)+((x>>53)&1)+((x>>54)&1)+((x>>55)&1)+((x>>56)&1)+((x>>57)&1)+((x>>58)&1)+((x>>59)&1)+((x>>60)&1)+((x>>61)&1)+((x>>62)&1)+((x>>63)&1)
    fcall count_bits_64, ret
    hex.cmp 2, count, ch, lt, eq, gt

  lt:
    output '<'
    ;end
  eq:
    output '='
    ;end
  gt:
    output '>'
    ;end

  end:
}


def test_shl n, x @ lt, eq, gt, xh, ch, end {
    hex.shl n, xh
    hex.cmp n, xh, ch, lt, eq, gt

  lt:
    output '<'
    ;end
  eq:
    output '='
    ;end
  gt:
    output '>'
    ;end

  xh: hex.vec n, x
  ch: hex.vec n, (x<<4)&((1<<(4*n))-1)
  end:
}

def test_shr n, x @ lt, eq, gt, xh, ch, end {
    hex.shr n, xh
    hex.cmp n, xh, ch, lt, eq, gt

  lt:
    output '<'
    ;end
  eq:
    output '='
    ;end
  gt:
    output '>'
    ;end

  xh: hex.vec n, x
  ch: hex.vec n, (x>>4)&((1<<(4*n))-1)
  end:
}
